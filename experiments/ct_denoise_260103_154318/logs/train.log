26-01-03 15:43:18.143 - INFO:   name: ct_denoise
  phase: train
  gpu_ids: [0]
  path:[
    log: experiments/ct_denoise_260103_154318/logs
    tb_logger: experiments/ct_denoise_260103_154318/tb_logger
    results: experiments/ct_denoise_260103_154318/results
    checkpoint: experiments/ct_denoise_260103_154318/checkpoint
    resume_state: None
    experiments: experiments
    experiments_root: experiments/ct_denoise_260103_154318
  ]
  datasets:[
    train:[
      name: ct
      dataroot: /host/d/file/fixedCT_static_simulation_train_test_gaussian_local.xlsx
      data_root: /host/d/file/simulation/
      train_batches: [0, 1, 2, 3, 4]
      val_batches: [5]
      valid_mask: [0, 1000]
      slice_range: [30, 80]
      phase: train
      padding: 3
      val_volume_idx: all
      val_slice_idx: all
      batch_size: 1
      in_channel: 1
      num_workers: 4
      use_shuffle: True
      image_size: 512
      lr_flip: 0.5
      HU_MIN: -1000.0
      HU_MAX: 2000.0
      histogram_equalization: True
      bins_file: /host/d/file/histogram_equalization/bins.npy
      bins_mapped_file: /host/d/file/histogram_equalization/bins_mapped.npy
      teacher_n2n_root: /host/d/file/pre/noise2noise/pred_images/
      teacher_n2n_epoch: 78
    ]
    val:[
      name: ct
      dataroot: /host/d/file/fixedCT_static_simulation_train_test_gaussian_local.xlsx
      data_root: /host/d/file/simulation/
      train_batches: [5]
      val_batches: [5]
      valid_mask: [0, 1000]
      slice_range: [30, 80]
      phase: val
      padding: 3
      val_volume_idx: all
      val_slice_idx: 25
      batch_size: 1
      in_channel: 1
      num_workers: 0
      image_size: 512
      lr_flip: 0.0
      HU_MIN: -1000.0
      HU_MAX: 2000.0
      histogram_equalization: True
      bins_file: /host/d/file/histogram_equalization/bins.npy
      bins_mapped_file: /host/d/file/histogram_equalization/bins_mapped.npy
      teacher_n2n_root: /host/d/file/pre/noise2noise/pred_images/
      teacher_n2n_epoch: 78
      data_len: 3
    ]
  ]
  model:[
    which_model_G: mri
    finetune_norm: False
    drop_rate: 0.0
    unet:[
      in_channel: 1
      out_channel: 1
      inner_channel: 32
      norm_groups: 32
      channel_multiplier: [1, 2, 4, 8, 8]
      attn_res: [16]
      res_blocks: 2
      dropout: 0.0
      version: v1
    ]
    beta_schedule:[
      train:[
        schedule: rev_warmup70
        n_timestep: 1000
        linear_start: 5e-05
        linear_end: 0.01
      ]
      val:[
        schedule: rev_warmup70
        n_timestep: 1000
        linear_start: 5e-05
        linear_end: 0.01
      ]
    ]
    diffusion:[
      image_size: 512
      channels: 1
      conditional: True
    ]
  ]
  train:[
    n_iter: 400000
    val_freq: 1000
    save_checkpoint_freq: 10000
    print_freq: 100
    optimizer:[
      type: adam
      lr: 0.0001
    ]
    ema_scheduler:[
      step_start_ema: 5000
      update_ema_every: 1
      ema_decay: 0.9999
    ]
  ]
  noise_model:[
    resume_state: None
    initial_stage_file: None
    drop_rate: 0.0
    unet:[
      in_channel: 2
      out_channel: 1
      inner_channel: 32
      norm_groups: 32
      channel_multiplier: [1, 2, 4, 8, 8]
      attn_res: [16]
      res_blocks: 2
      dropout: 0.0
      version: v1
    ]
    beta_schedule:[
      linear_start: 5e-05
      linear_end: 0.01
    ]
    n_iter: 50000
    val_freq: 200
    save_checkpoint_freq: 10000
    print_freq: 100
    optimizer:[
      type: adam
      lr: 0.0001
    ]
  ]
  stage2_file: experiments/ct_denoise_teacher/stage2_matched.txt
  data:[
    excel_path: /host/d/file/fixedCT_static_simulation_train_test_gaussian_local.xlsx
    data_root: /host/d/file/simulation/
    teacher_n2n_root: /host/d/file/pre/noise2noise/pred_images/
    teacher_n2n_epoch: 78
    bins_path: /host/d/file/histogram_equalization/bins.npy
    bins_mapped_path: /host/d/file/histogram_equalization/bins_mapped.npy
    stage2_file: experiments/ct_denoise_teacher/stage2_matched.txt
  ]
  distributed: False

26-01-03 15:43:21.502 - INFO: CT dataset [ct] is created. Size: 3450
26-01-03 15:43:24.194 - INFO: CT dataset [ct] is created. Size: 1
26-01-03 15:43:24.195 - INFO: Initial Dataset Finished
26-01-03 15:43:26.885 - INFO: Initialization method [orthogonal]
26-01-03 15:43:27.677 - INFO: [DDM2] is created.
26-01-03 15:43:27.677 - INFO: Initial Model Finished
26-01-03 15:44:02.652 - INFO: <epoch:  1, iter:     100> l_pix: 2.3028e-02 
26-01-03 15:44:25.007 - INFO: <epoch:  1, iter:     200> l_pix: 1.9647e-02 
26-01-03 15:44:44.875 - INFO: <epoch:  1, iter:     300> l_pix: 1.8383e-02 
26-01-03 15:45:07.395 - INFO: <epoch:  1, iter:     400> l_pix: 3.3541e-02 
26-01-03 15:45:27.213 - INFO: <epoch:  1, iter:     500> l_pix: 5.0329e-03 
26-01-03 15:45:48.305 - INFO: <epoch:  1, iter:     600> l_pix: 1.6066e-02 
26-01-03 15:46:08.438 - INFO: <epoch:  1, iter:     700> l_pix: 4.4008e-03 
26-01-03 15:46:32.238 - INFO: <epoch:  1, iter:     800> l_pix: 8.5839e-03 
